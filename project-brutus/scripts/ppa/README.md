ppa
===


Description
-----------
PPA is a performance, power and area modeling tool. It takes an input file
describing a processor and how each of the processor's components were accessed
during a simulation. It produces the cycle time, power and area of each core in
the processor, broken down by stage and component. 

Install
-------

    tar xvfz power.tgz
    add "/home/fabscalar/Python2.6/bin/" to $PATH
    $ virtualenv ppa
    $ source ppa/bin/activate.csh
    $ pip install -r requirements.txt
    $ pip install -e ./

Run
---

    $ add spice
    $ python bin/run_ppa.py [-h] [-p] [-v] [--debug] -i YAMLFILE

    required arguments:
    -i YAMLFILE, --yamlfile YAMLFILE
                            PPA file in YAML format to process

    optional arguments:
    -h, --help            show this help message and exit
    -p, --perfect_pipelining
                            Assume all stages (fetch to execute) are perfectly
                            balanced
    -v                    Increase the level of detail printed. (max: -vv)
    --debug               print debug messages

Components
----------
the basic building blocks are components and there are currently four types.

- Logic: 
    - this type represents the sequential and combinational logic in
      a stage. 
    - area, delay and energy numbers are retrieved from a database. the
      component name and some knobs (e.g. fetch_width) are used to do the
      lookup. see power_db.py for each stage's required parameters.
    - the area, delay, energy numbers were taken after synthesis of the
      entire stage, but do not include SRAMs or other custom devices, only standard
      cells. the delay is the portion of the critical path that the standard cells
      contribute. any SRAMs or other structures must be added to this delay to get
      the true delay of the stage. 
    - the area, delay and energy numbers retrieved from the database are for the 
      entire component, not per 'way'. therefore, n instructions passing through
      the stage constitutes one access, where n is the width of the stage. 

- SRAM/CAM
    - this type represents a static RAM or CAM.
    - area, delay and energy are generated by FabMem.
    - required parameters
        - words: number of words in the memory.
        - width: width of each word, in bits.
        - read_ports: number of read-only ports.
        - write_ports: number of write-only ports.
        - read_accesses: number of read accesses.
        - write_accesses: number of write accesses.
    - these numbers are stored in a database after being generated to avoid
      having to regenerate them.
    - memories are limited to 45nm (FreePDK45), 512 words for RAMs and 256 words
      for CAMs.
    - ports are limited to either 2xR-xW or xR-xW for RAMS and xR-xW for CAMs,
      where 1 <= x <= 8

- CactiSRAM
    - this type is another way of representing an SRAM.
    - area, delay and energy are generated using cacti 6.5.
    - required parameters
        - words: number of words in the memory.
        - width: width of each word, in bits.
    - see cacti.py for all available parameters and default values.

- Cache
    - this type represents a cache, including tag and data arrays
    - area, delay and energy are generated using cacti 6.5.
    - required parameters
        - sets: number of blocks in each way.
        - block_size: width of each block, in bytes.
    - see cacti.py for all available parameters and default values.

Stages
------

stages require one or more components and one or more paths. each path is a
list of components that forms a possible critical path through the stage. the
delay of each component in a path is summed, and the path with the largest
delay decides the total delay of that stage. the area and energy of the stage 
includes the summation of all its components.

Cores
-----

- cores are made up of stages (e.g. rename) and loose components (e.g. L2
  cache). 
- the total area and energy of the core is the summation of all its
  stages and components. 
- the cycle time of the core is, by default, the greatest
  delay of a single stage in the list 'fetch\_to\_exe\_stages'. if
  perfect\_pipelining is enabled, the total delay of all stages in
  'fetch\_to\_exe\_stages' is divided by 'fetch\_to\_exe\_depth'. if
  'fetch\_to\_exe\_depth' is not specified, then the length of
  'fetch\_to\_exe\_stages' is used.
- required parameters
    - cycles: total number of cycles. this is used to calculate total energy
    - fetch\_to\_exe\_stages: list of the stages between fetch and execute
      (inclusive).
    - stages: list of stages in the core 

sim2ppa
=======

Usage
-----

    $ python bin/sim2ppa.py [-h] [--debug] -t TEMPLATE -s SIMFILE -o OUTFILE

    required arguments:
    -t TEMPLATE, --template TEMPLATE
                            Template file to render
    -s SIMFILE, --simfile SIMFILE
                            file containing simulation knobs and stats
    -o OUTFILE, --outfile OUTFILE
                            file to which the rendered template will be written

    optional arguments:
    -h, --help            show this help message and exit
    --debug               print debug messages
